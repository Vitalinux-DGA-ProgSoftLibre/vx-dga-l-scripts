#!/bin/bash
USER=$(whoami)

if test $USER = "root" ; then

	RUTAS="/etc/xdg/autostart/migasfree-launcher.desktop /etc/xdg/autostart/migasfree-indicator.desktop"

	if yad --title "Comportamiento del Cliente Migasfree" \
		--text "  Indica que quieres Hacer con el Cliente Migasfree ...  " \
		--image migasfree-256x --window-icon vitalinux-256x \
		--width="350" --height="100" --justify="center" --center --text-align="center" \
		--button="Deshabilitar Cliente Migasfree":0  --button="Habilitar Cliente Migasfree":1 ; then

		for RUTA in ${RUTAS} ; do
			if test -f "$RUTA" ; then
				if chmod 000 "$RUTA" ; then
								yad --title "Comportamiento del Cliente Migasfree" \
					--text "  Se ha deshabilitado el Cliente Migasfree  \n  Lo podrás comprobar la próxima vez que inicies sesión  " \
					--image migasfree-256x --window-icon vitalinux-256x \
					--width="350" --height="100" \
					--justify="center" --center --text-align="center" \
					--timeout=7 \
					--button="Cerrar Ventana":0
				fi
			fi
		done
	else

		# En la nueva versión de vx-dga-l-dock-plank el lanzador esta en /etc/xdg/autostart
		for RUTA in ${RUTAS} ; do
			if test -f "$RUTA" ; then
				if chmod 644 "$RUTA" ; then
					yad --title "Comportamiento del Cliente Migasfree" \
					--text "  Se ha habilitado el Cliente Migasfree  \n  Lo podrás comprobar la próxima vez que inicies sesión  " \
					--image migasfree-256x --window-icon vitalinux-256x \
					--width="350" --height="100" \
					--justify="center" --center --text-align="center" \
					--timeout=7 \
					--button="Cerrar Ventana":0
				fi
			fi
		done
		
	fi
else
		yad --title "Comportamiento del Cliente Migasfree" \
			--image migasfree-256x --window-icon vitalinux-256x \
			--info --text "No tiene permiso para ejecutar el programa" \
			--width="400" --height="100" --center --justify="center" --timeout=7 --text-align="center"
fi
